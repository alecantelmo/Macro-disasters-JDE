function derivs=prePI_d1(vars,params,index)
n_s=size(vars,1);
auxvar1p=vars(:,1);
nlp=vars(:,2);
logtilqep=vars(:,3);
logqfp=vars(:,4);
auxvar1=vars(:,5);
nl=vars(:,6);
logtilqe=vars(:,7);
logqf=vars(:,8);
logtilkstarbackp=vars(:,9);
dp=vars(:,10);
logthetap=vars(:,11);
zap=vars(:,12);
logtilkstarback=vars(:,13);
d=vars(:,14);
logtheta=vars(:,15);
za=vars(:,16);
loghata=vars(:,17);
loghatap=vars(:,18);
loghatz=vars(:,19);
loghatzp=vars(:,20);
u1=vars(:,21);
u1p=vars(:,22);
u2=vars(:,23);
u2p=vars(:,24);
logtilv_tilvss=vars(:,25);
logtilvp_tilvss=vars(:,26);
l=vars(:,27);
lp=vars(:,28);
logtilu=vars(:,29);
logtilup=vars(:,30);
loguc=vars(:,31);
logucp=vars(:,32);
logtillambda=vars(:,33);
logtillambdap=vars(:,34);
logtilc=vars(:,35);
logtilcp=vars(:,36);
logmnom=vars(:,37);
logmnomp=vars(:,38);
logmden=vars(:,39);
theta=vars(:,40);
thetap=vars(:,41);
tilrp=vars(:,42);
tilq=vars(:,43);
tilqp=vars(:,44);
logtilr=vars(:,45);
logtilrp=vars(:,46);
logtilw=vars(:,47);
logtilwp=vars(:,48);
u4=vars(:,49);
tilc=vars(:,50);
tilcp=vars(:,51);
tilx=vars(:,52);
tilxp=vars(:,53);
logtilx=vars(:,54);
logtilk=vars(:,55);
u01p=vars(:,56);
u02=vars(:,57);
u03=vars(:,58);
u04=vars(:,59);
u05=vars(:,60);
logMp=vars(:,61);
u17=vars(:,62);
u4p=vars(:,63);
tily=vars(:,64);
logtily=vars(:,65);
tilyp=vars(:,66);
logtilyp=vars(:,67);
w=vars(:,68);
wp=vars(:,69);
tildiv=vars(:,70);
tildivp=vars(:,71);
MUD=params(1);
RHOTHETA=params(2);
THETABAR=params(3);
SDV_THETA=params(4);
SDV_ZA=params(5);
ALPHA=params(6);
LAMBDA_A=params(7);
GAMMA=params(8);
NU=params(9);
PSI=params(10);
BETA=params(11);
DELTA=params(12);
PHI=params(13);
SCALEPARAM=params(14);
LOGTILUSS=params(15);
full_rows=zeros(74,1);
full_cols=zeros(74,1);
full_vals=zeros(n_s,74);
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{1,1});
full_vals(:,1:1)=uncompressed_deriv;
full_cols(1:1,:)=index.loc{1,1};
full_rows(1:1)=1;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{2,1});
full_vals(:,2:2)=uncompressed_deriv;
full_cols(2:2,:)=index.loc{2,1};
full_rows(2:2)=2;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{3,1});
full_vals(:,3:3)=uncompressed_deriv;
full_cols(3:3,:)=index.loc{3,1};
full_rows(3:3)=3;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{4,1});
full_vals(:,4:4)=uncompressed_deriv;
full_cols(4:4,:)=index.loc{4,1};
full_rows(4:4)=4;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{5,1});
full_vals(:,5:5)=uncompressed_deriv;
full_cols(5:5,:)=index.loc{5,1};
full_rows(5:5)=5;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{6,1});
full_vals(:,6:6)=uncompressed_deriv;
full_cols(6:6,:)=index.loc{6,1};
full_rows(6:6)=6;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{7,1});
full_vals(:,7:7)=uncompressed_deriv;
full_cols(7:7,:)=index.loc{7,1};
full_rows(7:7)=7;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{8,1});
full_vals(:,8:8)=uncompressed_deriv;
full_cols(8:8,:)=index.loc{8,1};
full_rows(8:8)=8;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{9,1});
full_vals(:,9:9)=uncompressed_deriv;
full_cols(9:9,:)=index.loc{9,1};
full_rows(9:9)=9;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{10,1});
full_vals(:,10:10)=uncompressed_deriv;
full_cols(10:10,:)=index.loc{10,1};
full_rows(10:10)=10;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{11,1});
full_vals(:,11:11)=uncompressed_deriv;
full_cols(11:11,:)=index.loc{11,1};
full_rows(11:11)=11;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{12,1});
full_vals(:,12:12)=uncompressed_deriv;
full_cols(12:12,:)=index.loc{12,1};
full_rows(12:12)=12;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{13,1});
full_vals(:,13:13)=uncompressed_deriv;
full_cols(13:13,:)=index.loc{13,1};
full_rows(13:13)=13;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{14,1});
full_vals(:,14:14)=uncompressed_deriv;
full_cols(14:14,:)=index.loc{14,1};
full_rows(14:14)=14;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{15,1});
full_vals(:,15:15)=uncompressed_deriv;
full_cols(15:15,:)=index.loc{15,1};
full_rows(15:15)=15;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{16,1});
full_vals(:,16:16)=uncompressed_deriv;
full_cols(16:16,:)=index.loc{16,1};
full_rows(16:16)=16;
compressed_deriv=zeros(n_s,3);
compressed_deriv(:,1)=exp(logtheta).*(ALPHA - 1);
compressed_deriv(:,2)=d.*exp(logtheta).*(ALPHA - 1);
compressed_deriv(:,3)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{17,1});
full_vals(:,17:19)=uncompressed_deriv;
full_cols(17:19,:)=index.loc{17,1};
full_rows(17:19)=17;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=-1./(ALPHA - 1);
uncompressed_deriv=compressed_deriv(:,index.nnz{19,1});
full_vals(:,20:20)=uncompressed_deriv;
full_cols(20:20,:)=index.loc{19,1};
full_rows(20:20)=19;
compressed_deriv=zeros(n_s,2);
compressed_deriv(:,1)=(BETA.*exp((auxvar1.*(PSI - 1))./(GAMMA - 1)).*(PSI - 1))./(GAMMA - 1);
compressed_deriv(:,2)=SCALEPARAM.*exp(u2);
uncompressed_deriv=compressed_deriv(:,index.nnz{21,1});
full_vals(:,21:22)=uncompressed_deriv;
full_cols(21:22,:)=index.loc{21,1};
full_rows(21:22)=21;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1 - PSI;
uncompressed_deriv=compressed_deriv(:,index.nnz{23,1});
full_vals(:,23:23)=uncompressed_deriv;
full_cols(23:23,:)=index.loc{23,1};
full_rows(23:23)=23;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=-1./(u1.*(PSI - 1));
uncompressed_deriv=compressed_deriv(:,index.nnz{25,1});
full_vals(:,24:24)=uncompressed_deriv;
full_cols(24:24,:)=index.loc{25,1};
full_rows(24:24)=25;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=-exp(nl - log(exp(nl) + 1)).*(exp(nl)./(exp(nl) + 1) - 1);
uncompressed_deriv=compressed_deriv(:,index.nnz{27,1});
full_vals(:,25:25)=uncompressed_deriv;
full_cols(25:25,:)=index.loc{27,1};
full_rows(25:25)=27;
compressed_deriv=zeros(n_s,2);
compressed_deriv(:,1)=NU./(l - 1);
compressed_deriv(:,2)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{29,1});
full_vals(:,26:27)=uncompressed_deriv;
full_cols(26:27,:)=index.loc{29,1};
full_rows(26:27)=29;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=NU./(l - 1);
uncompressed_deriv=compressed_deriv(:,index.nnz{31,1});
full_vals(:,28:28)=uncompressed_deriv;
full_cols(28:28,:)=index.loc{31,1};
full_rows(28:28)=31;
compressed_deriv=zeros(n_s,2);
compressed_deriv(:,1)=-PSI;
compressed_deriv(:,2)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{33,1});
full_vals(:,29:30)=uncompressed_deriv;
full_cols(29:30,:)=index.loc{33,1};
full_rows(29:30)=33;
compressed_deriv=zeros(n_s,2);
compressed_deriv(:,1)=1./(l - 1);
compressed_deriv(:,2)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{35,1});
full_vals(:,31:32)=uncompressed_deriv;
full_cols(31:32,:)=index.loc{35,1};
full_rows(31:32)=35;
compressed_deriv=zeros(n_s,3);
compressed_deriv(:,1)=-GAMMA;
compressed_deriv(:,2)=PSI - GAMMA;
compressed_deriv(:,3)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{37,1});
full_vals(:,33:35)=uncompressed_deriv;
full_cols(33:35,:)=index.loc{37,1};
full_rows(33:35)=37;
compressed_deriv=zeros(n_s,2);
compressed_deriv(:,1)=(GAMMA - PSI)./(GAMMA - 1);
compressed_deriv(:,2)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{39,1});
full_vals(:,36:37)=uncompressed_deriv;
full_cols(36:37,:)=index.loc{39,1};
full_rows(36:37)=39;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=exp(logtheta);
uncompressed_deriv=compressed_deriv(:,index.nnz{40,1});
full_vals(:,38:38)=uncompressed_deriv;
full_cols(38:38,:)=index.loc{40,1};
full_rows(38:38)=40;
compressed_deriv=zeros(n_s,5);
compressed_deriv(:,1)=(exp(nl)./(exp(nl) + 1) - 1).*(ALPHA - 1);
compressed_deriv(:,2)=ALPHA - 1;
compressed_deriv(:,3)=-theta.*(ALPHA - 1);
compressed_deriv(:,4)=1;
compressed_deriv(:,5)=-d.*(ALPHA - 1);
uncompressed_deriv=compressed_deriv(:,index.nnz{45,1});
full_vals(:,39:43)=uncompressed_deriv;
full_cols(39:43,:)=index.loc{45,1};
full_rows(39:43)=45;
compressed_deriv=zeros(n_s,6);
compressed_deriv(:,1)=ALPHA.*(exp(nl)./(exp(nl) + 1) - 1);
compressed_deriv(:,2)=ALPHA;
compressed_deriv(:,3)=-ALPHA.*theta;
compressed_deriv(:,4)=1;
compressed_deriv(:,5)=-1;
compressed_deriv(:,6)=-ALPHA.*d;
uncompressed_deriv=compressed_deriv(:,index.nnz{47,1});
full_vals(:,44:49)=uncompressed_deriv;
full_cols(44:49,:)=index.loc{47,1};
full_rows(44:49)=47;
compressed_deriv=zeros(n_s,6);
compressed_deriv(:,1)=(exp(nl)./(exp(nl) + 1) - 1).*(ALPHA - 1);
compressed_deriv(:,2)=ALPHA;
compressed_deriv(:,3)=-ALPHA.*theta;
compressed_deriv(:,4)=1;
compressed_deriv(:,5)=-1;
compressed_deriv(:,6)=-ALPHA.*d;
uncompressed_deriv=compressed_deriv(:,index.nnz{49,1});
full_vals(:,50:55)=uncompressed_deriv;
full_cols(50:55,:)=index.loc{49,1};
full_rows(50:55)=49;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=exp(logtilc);
uncompressed_deriv=compressed_deriv(:,index.nnz{50,1});
full_vals(:,56:56)=uncompressed_deriv;
full_cols(56:56,:)=index.loc{50,1};
full_rows(56:56)=50;
compressed_deriv=zeros(n_s,2);
compressed_deriv(:,1)=exp(u4);
compressed_deriv(:,2)=-1;
uncompressed_deriv=compressed_deriv(:,index.nnz{52,1});
full_vals(:,57:58)=uncompressed_deriv;
full_cols(57:58,:)=index.loc{52,1};
full_rows(57:58)=52;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1./tilx;
uncompressed_deriv=compressed_deriv(:,index.nnz{54,1});
full_vals(:,59:59)=uncompressed_deriv;
full_cols(59:59,:)=index.loc{54,1};
full_rows(59:59)=54;
compressed_deriv=zeros(n_s,4);
compressed_deriv(:,1)=1;
compressed_deriv(:,2)=-theta;
compressed_deriv(:,3)=-1;
compressed_deriv(:,4)=-d;
uncompressed_deriv=compressed_deriv(:,index.nnz{55,1});
full_vals(:,60:63)=uncompressed_deriv;
full_cols(60:63,:)=index.loc{55,1};
full_rows(60:63)=55;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=-exp(-auxvar1);
uncompressed_deriv=compressed_deriv(:,index.nnz{57,1});
full_vals(:,64:64)=uncompressed_deriv;
full_cols(64:64,:)=index.loc{57,1};
full_rows(64:64)=57;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=-1./tilq.^2;
uncompressed_deriv=compressed_deriv(:,index.nnz{59,1});
full_vals(:,65:65)=uncompressed_deriv;
full_cols(65:65,:)=index.loc{59,1};
full_rows(65:65)=59;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=-exp(-logtilx);
uncompressed_deriv=compressed_deriv(:,index.nnz{60,1});
full_vals(:,66:66)=uncompressed_deriv;
full_cols(66:66,:)=index.loc{60,1};
full_rows(66:66)=60;
compressed_deriv=zeros(n_s,2);
compressed_deriv(:,1)=1;
compressed_deriv(:,2)=1;
uncompressed_deriv=compressed_deriv(:,index.nnz{64,1});
full_vals(:,67:68)=uncompressed_deriv;
full_cols(67:68,:)=index.loc{64,1};
full_rows(67:68)=64;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=1./tily;
uncompressed_deriv=compressed_deriv(:,index.nnz{65,1});
full_vals(:,69:69)=uncompressed_deriv;
full_cols(69:69,:)=index.loc{65,1};
full_rows(69:69)=65;
compressed_deriv=zeros(n_s,1);
compressed_deriv(:,1)=exp(logtilw);
uncompressed_deriv=compressed_deriv(:,index.nnz{68,1});
full_vals(:,70:70)=uncompressed_deriv;
full_cols(70:70,:)=index.loc{68,1};
full_rows(70:70)=68;
compressed_deriv=zeros(n_s,4);
compressed_deriv(:,1)=-w;
compressed_deriv(:,2)=-1;
compressed_deriv(:,3)=1;
compressed_deriv(:,4)=-l;
uncompressed_deriv=compressed_deriv(:,index.nnz{70,1});
full_vals(:,71:74)=uncompressed_deriv;
full_cols(71:74,:)=index.loc{70,1};
full_rows(71:74)=70;
derivs=sptensor(full_rows,full_cols,full_vals,71,repmat(71,1,1));
