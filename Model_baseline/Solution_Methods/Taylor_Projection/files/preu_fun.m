function function_f=preu_fun(variables_v,parameters)
MUD=parameters(1);
RHOTHETA=parameters(2);
THETABAR=parameters(3);
SDV_THETA=parameters(4);
SDV_ZA=parameters(5);
ALPHA=parameters(6);
LAMBDA_A=parameters(7);
GAMMA=parameters(8);
NU=parameters(9);
PSI=parameters(10);
BETA=parameters(11);
DELTA=parameters(12);
PHI=parameters(13);
SCALEPARAM=parameters(14);
LOGTILUSS=parameters(15);
auxvar1=variables_v(1,:);
nl=variables_v(2,:);
logtilkstarback=variables_v(3,:);
d=variables_v(4,:);
logtheta=variables_v(5,:);
za=variables_v(6,:);
function_f=zeros(29,size(variables_v,2));
function_f(1,:)=LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1);
function_f(2,:)=-(LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1);
function_f(3,:)=SCALEPARAM.*exp(-(PSI - 1).*(LAMBDA_A - LOGTILUSS + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + NU.*log(1 - exp(nl - log(exp(nl) + 1))) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1))) + BETA.*exp((auxvar1.*(PSI - 1))./(GAMMA - 1));
function_f(4,:)=-(PSI - 1).*(LAMBDA_A - LOGTILUSS + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + NU.*log(1 - exp(nl - log(exp(nl) + 1))) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1));
function_f(5,:)=-log(SCALEPARAM.*exp(-(PSI - 1).*(LAMBDA_A - LOGTILUSS + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + NU.*log(1 - exp(nl - log(exp(nl) + 1))) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1))) + BETA.*exp((auxvar1.*(PSI - 1))./(GAMMA - 1)))./(PSI - 1);
function_f(6,:)=exp(nl - log(exp(nl) + 1));
function_f(7,:)=LAMBDA_A + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + NU.*log(1 - exp(nl - log(exp(nl) + 1))) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1);
function_f(8,:)=NU.*log(1 - exp(nl - log(exp(nl) + 1)));
function_f(9,:)=log(1 - PSI) + NU.*log(1 - exp(nl - log(exp(nl) + 1))) - PSI.*(LAMBDA_A + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + NU.*log(1 - exp(nl - log(exp(nl) + 1))) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1));
function_f(10,:)=LAMBDA_A + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1);
function_f(11,:)=log(1 - PSI) + log(BETA) + NU.*log(1 - exp(nl - log(exp(nl) + 1))) - PSI.*(LAMBDA_A + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + NU.*log(1 - exp(nl - log(exp(nl) + 1))) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1)) + (PSI.*(LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1)))./(ALPHA - 1) + ((GAMMA - PSI).*(LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1)))./(ALPHA - 1) + (log(SCALEPARAM.*exp(-(PSI - 1).*(LAMBDA_A - LOGTILUSS + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + NU.*log(1 - exp(nl - log(exp(nl) + 1))) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1))) + BETA.*exp((auxvar1.*(PSI - 1))./(GAMMA - 1))).*(GAMMA - PSI))./(PSI - 1);
function_f(12,:)=log(1 - PSI) + NU.*log(1 - exp(nl - log(exp(nl) + 1))) - PSI.*(LAMBDA_A + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + NU.*log(1 - exp(nl - log(exp(nl) + 1))) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1)) + (auxvar1.*(GAMMA - PSI))./(GAMMA - 1);
function_f(13,:)=exp(logtheta);
function_f(14,:)=1;
function_f(15,:)=1;
function_f(16,:)=LAMBDA_A + za + log(ALPHA) + (logtilkstarback - d.*exp(logtheta)).*(ALPHA - 1) - (ALPHA - 1).*(nl - log(exp(nl) + 1)) + d.*exp(logtheta).*(ALPHA - 1);
function_f(17,:)=LAMBDA_A + za + log(1 - ALPHA) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1);
function_f(18,:)=LAMBDA_A + za + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) - (ALPHA - 1).*(nl - log(exp(nl) + 1)) + d.*exp(logtheta).*(ALPHA - 1);
function_f(19,:)=exp(LAMBDA_A + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1));
function_f(20,:)=exp(LAMBDA_A + za + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) - (ALPHA - 1).*(nl - log(exp(nl) + 1)) + d.*exp(logtheta).*(ALPHA - 1)) - PHI - exp(LAMBDA_A + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1));
function_f(21,:)=log(exp(LAMBDA_A + za + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) - (ALPHA - 1).*(nl - log(exp(nl) + 1)) + d.*exp(logtheta).*(ALPHA - 1)) - PHI - exp(LAMBDA_A + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1)));
function_f(22,:)=logtilkstarback - d.*exp(logtheta) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1);
function_f(23,:)=exp(-auxvar1);
function_f(24,:)=1;
function_f(25,:)=-1./(PHI - exp(LAMBDA_A + za + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) - (ALPHA - 1).*(nl - log(exp(nl) + 1)) + d.*exp(logtheta).*(ALPHA - 1)) + exp(LAMBDA_A + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1)));
function_f(26,:)=exp(LAMBDA_A + za + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) - (ALPHA - 1).*(nl - log(exp(nl) + 1)) + d.*exp(logtheta).*(ALPHA - 1)) - PHI;
function_f(27,:)=log(exp(LAMBDA_A + za + ALPHA.*(logtilkstarback - d.*exp(logtheta)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) - (ALPHA - 1).*(nl - log(exp(nl) + 1)) + d.*exp(logtheta).*(ALPHA - 1)) - PHI);
function_f(28,:)=exp(LAMBDA_A + za + log(1 - ALPHA) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1));
function_f(29,:)=exp(LAMBDA_A + za + log(1 - exp(nl - log(exp(nl) + 1))) + log(1 - ALPHA) - log(NU) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1)) - exp(nl - log(exp(nl) + 1)).*exp(LAMBDA_A + za + log(1 - ALPHA) + ALPHA.*(logtilkstarback - d.*exp(logtheta)) - ALPHA.*(nl - log(exp(nl) + 1)) + (LAMBDA_A + za + d.*exp(logtheta).*(ALPHA - 1))./(ALPHA - 1) + d.*exp(logtheta).*(ALPHA - 1));
