function derivs=f_d3(vars,params,index)
auxvar1p=vars(1);
logtilvp_tilvss=vars(2);
logtilup=vars(3);
logtilcp=vars(4);
nlp=vars(5);
logtillambdap=vars(6);
logtilwp=vars(7);
logucp=vars(8);
lognegtilulp=vars(9);
logmnomp=vars(10);
logmdenp=vars(11);
logtilrp=vars(12);
logtilqp=vars(13);
logtilxp=vars(14);
logtilkp=vars(15);
logtilyp=vars(16);
logtilqep=vars(17);
logqfp=vars(18);
tildivp=vars(19);
auxvar1=vars(20);
logtilv_tilvss=vars(21);
logtilu=vars(22);
logtilc=vars(23);
nl=vars(24);
logtillambda=vars(25);
logtilw=vars(26);
loguc=vars(27);
lognegtilul=vars(28);
logmnom=vars(29);
logmden=vars(30);
logtilr=vars(31);
logtilq=vars(32);
logtilx=vars(33);
logtilk=vars(34);
logtily=vars(35);
logtilqe=vars(36);
logqf=vars(37);
tildiv=vars(38);
logtilkstarbackp=vars(39);
dp=vars(40);
logthetap=vars(41);
zap=vars(42);
sigmap_perturbation=vars(43);
logtilkstarback=vars(44);
d=vars(45);
logtheta=vars(46);
za=vars(47);
sigma_perturbation=vars(48);
MUD=params(1);
RHOTHETA=params(2);
THETABAR=params(3);
SDV_THETA=params(4);
SDV_ZA=params(5);
ALPHA=params(6);
LAMBDA_A=params(7);
GAMMA=params(8);
NU=params(9);
PSI=params(10);
BETA=params(11);
DELTA=params(12);
PHI=params(13);
SCALEPARAM=params(14);
LOGTILUSS=params(15);
full_rows=zeros(592,1);
full_vals=zeros(592,1);
compressed_deriv=zeros(21,1);
compressed_deriv(1)=-exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3;
compressed_deriv(2)=exp(logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3;
compressed_deriv(3)=dp*exp(logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3;
compressed_deriv(4)=(exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3)/(ALPHA - 1);
compressed_deriv(5)=-exp(2*logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3;
compressed_deriv(6)=- exp(logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^2 - dp*exp(2*logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3;
compressed_deriv(7)=-(exp(logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3)/(ALPHA - 1);
compressed_deriv(8)=- dp^2*exp(2*logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3 - dp*exp(logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^2;
compressed_deriv(9)=-(dp*exp(logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3)/(ALPHA - 1);
compressed_deriv(10)=-(exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3)/(ALPHA - 1)^2;
compressed_deriv(11)=-exp(auxvar1);
compressed_deriv(12)=exp(3*logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3;
compressed_deriv(13)=2*exp(2*logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^2 + dp*exp(3*logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3;
compressed_deriv(14)=(exp(2*logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3)/(ALPHA - 1);
compressed_deriv(15)=exp(logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1) + dp^2*exp(3*logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3 + 3*dp*exp(2*logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^2;
compressed_deriv(16)=(exp(logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^2)/(ALPHA - 1) + (dp*exp(2*logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3)/(ALPHA - 1);
compressed_deriv(17)=(exp(logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3)/(ALPHA - 1)^2;
compressed_deriv(18)=dp*exp(logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1) + 3*dp^2*exp(2*logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^2 + dp^3*exp(3*logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3;
compressed_deriv(19)=(dp^2*exp(2*logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3)/(ALPHA - 1) + (dp*exp(logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^2)/(ALPHA - 1);
compressed_deriv(20)=(dp*exp(logthetap)*exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3)/(ALPHA - 1)^2;
compressed_deriv(21)=(exp(-(logtilvp_tilvss - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(GAMMA - 1))*(GAMMA - 1)^3)/(ALPHA - 1)^3;
uncompressed_deriv=compressed_deriv(index.nnz{1,3});
full_vals(1:65)=uncompressed_deriv;
full_rows(1:65)=index.loc{1,3};
compressed_deriv=zeros(3,1);
compressed_deriv(1)=(BETA*exp((auxvar1*(PSI - 1))/(GAMMA - 1))*(PSI - 1)^3)/(GAMMA - 1)^3;
compressed_deriv(2)=exp(-logtilv_tilvss*(PSI - 1))*(PSI - 1)^3;
compressed_deriv(3)=-SCALEPARAM*exp((LOGTILUSS - logtilu)*(PSI - 1))*(PSI - 1)^3;
uncompressed_deriv=compressed_deriv(index.nnz{2,3});
full_vals(66:68)=uncompressed_deriv;
full_rows(66:68)=index.loc{2,3};
compressed_deriv=zeros(1,1);
compressed_deriv(1)=(3*NU*exp(2*nl))/(exp(nl) + 1)^2 - (NU*exp(nl))/(exp(nl) + 1) - (2*NU*exp(3*nl))/(exp(nl) + 1)^3;
uncompressed_deriv=compressed_deriv(index.nnz{3,3});
full_vals(69:69)=uncompressed_deriv;
full_rows(69:69)=index.loc{3,3};
compressed_deriv=zeros(1,1);
compressed_deriv(1)=(3*NU*exp(2*nl))/(exp(nl) + 1)^2 - (NU*exp(nl))/(exp(nl) + 1) - (2*NU*exp(3*nl))/(exp(nl) + 1)^3;
uncompressed_deriv=compressed_deriv(index.nnz{4,3});
full_vals(70:70)=uncompressed_deriv;
full_rows(70:70)=index.loc{4,3};
compressed_deriv=zeros(1,1);
compressed_deriv(1)=((exp(nl) + 1)^NU*(exp(nl)/(exp(nl) + 1)^NU - (6*NU*exp(2*nl))/(exp(nl) + 1)^(NU + 1) + (3*NU*exp(3*nl)*(NU + 1))/(exp(nl) + 1)^(NU + 2) - (NU*exp(nl)*(exp(nl) + 1))/(exp(nl) + 1)^(NU + 1) + (3*NU*exp(2*nl)*(exp(nl) + 1)*(NU + 1))/(exp(nl) + 1)^(NU + 2) - (NU*exp(3*nl)*(exp(nl) + 1)*(NU + 1)*(NU + 2))/(exp(nl) + 1)^(NU + 3)))/(exp(nl) + 1) + (2*exp(2*nl)*(exp(nl)/(exp(nl) + 1)^NU - (NU*exp(nl)*(exp(nl) + 1))/(exp(nl) + 1)^(NU + 1))*(exp(nl) + 1)^NU)/(exp(nl) + 1)^3 - (2*exp(nl)*(exp(nl) + 1)^NU*(exp(nl)/(exp(nl) + 1)^NU - (2*NU*exp(2*nl))/(exp(nl) + 1)^(NU + 1) - (NU*exp(nl)*(exp(nl) + 1))/(exp(nl) + 1)^(NU + 1) + (NU*exp(2*nl)*(exp(nl) + 1)*(NU + 1))/(exp(nl) + 1)^(NU + 2)))/(exp(nl) + 1)^2 - (exp(nl)*(exp(nl)/(exp(nl) + 1)^NU - (NU*exp(nl)*(exp(nl) + 1))/(exp(nl) + 1)^(NU + 1))*(exp(nl) + 1)^NU)/(exp(nl) + 1)^2 + (2*NU*exp(nl)*(exp(nl) + 1)^(NU - 1)*(exp(nl)/(exp(nl) + 1)^NU - (2*NU*exp(2*nl))/(exp(nl) + 1)^(NU + 1) - (NU*exp(nl)*(exp(nl) + 1))/(exp(nl) + 1)^(NU + 1) + (NU*exp(2*nl)*... 
 (exp(nl) + 1)*(NU + 1))/(exp(nl) + 1)^(NU + 2)))/(exp(nl) + 1) + (NU*exp(nl)*(exp(nl)/(exp(nl) + 1)^NU - (NU*exp(nl)*(exp(nl) + 1))/(exp(nl) + 1)^(NU + 1))*(exp(nl) + 1)^(NU - 1))/(exp(nl) + 1) - (2*NU*exp(2*nl)*(exp(nl)/(exp(nl) + 1)^NU - (NU*exp(nl)*(exp(nl) + 1))/(exp(nl) + 1)^(NU + 1))*(exp(nl) + 1)^(NU - 1))/(exp(nl) + 1)^2 + (NU*exp(2*nl)*(exp(nl)/(exp(nl) + 1)^NU - (NU*exp(nl)*(exp(nl) + 1))/(exp(nl) + 1)^(NU + 1))*(exp(nl) + 1)^(NU - 2)*(NU - 1))/(exp(nl) + 1);
uncompressed_deriv=compressed_deriv(index.nnz{5,3});
full_vals(71:71)=uncompressed_deriv;
full_rows(71:71)=index.loc{5,3};
compressed_deriv=zeros(2,1);
compressed_deriv(1)=PSI*exp(logtheta) + exp(logtheta)*(GAMMA - PSI);
compressed_deriv(2)=PSI*d*exp(logtheta) + d*exp(logtheta)*(GAMMA - PSI);
uncompressed_deriv=compressed_deriv(index.nnz{8,3});
full_vals(72:75)=uncompressed_deriv;
full_rows(72:75)=index.loc{8,3};
compressed_deriv=zeros(51,1);
compressed_deriv(1)=exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(2)=exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp);
compressed_deriv(3)=-exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*(DELTA - 1);
compressed_deriv(4)=-exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(5)=-exp(logmnomp - logmden - dp*exp(logthetap))*exp(logthetap)*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(6)=-dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logthetap)*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(7)=exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp);
compressed_deriv(8)=-exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp);
compressed_deriv(9)=-exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp)*exp(logthetap);
compressed_deriv(10)=-dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp)*exp(logthetap);
compressed_deriv(11)=-exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*(DELTA - 1);
compressed_deriv(12)=exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*(DELTA - 1);
compressed_deriv(13)=exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*exp(logthetap)*(DELTA - 1);
compressed_deriv(14)=dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*exp(logthetap)*(DELTA - 1);
compressed_deriv(15)=exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(16)=exp(logmnomp - logmden - dp*exp(logthetap))*exp(logthetap)*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(17)=dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logthetap)*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(18)=exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(19)=dp*exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1)) - exp(logmnomp - logmden - dp*exp(logthetap))*exp(logthetap)*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(20)=dp^2*exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1)) - dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logthetap)*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(21)=exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp);
compressed_deriv(22)=-exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp);
compressed_deriv(23)=-exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp)*exp(logthetap);
compressed_deriv(24)=-dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp)*exp(logthetap);
compressed_deriv(25)=exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp);
compressed_deriv(26)=exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp)*exp(logthetap);
compressed_deriv(27)=dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp)*exp(logthetap);
compressed_deriv(28)=exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp);
compressed_deriv(29)=dp*exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp) - exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp)*exp(logthetap);
compressed_deriv(30)=dp^2*exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp) - dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilrp)*exp(logthetap);
compressed_deriv(31)=-exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*(DELTA - 1);
compressed_deriv(32)=exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*(DELTA - 1);
compressed_deriv(33)=exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*exp(logthetap)*(DELTA - 1);
compressed_deriv(34)=dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*exp(logthetap)*(DELTA - 1);
compressed_deriv(35)=-exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*(DELTA - 1);
compressed_deriv(36)=-exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*exp(logthetap)*(DELTA - 1);
compressed_deriv(37)=-dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*exp(logthetap)*(DELTA - 1);
compressed_deriv(38)=-exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*(DELTA - 1);
compressed_deriv(39)=exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*exp(logthetap)*(DELTA - 1) - dp*exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*(DELTA - 1);
compressed_deriv(40)=dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*exp(logthetap)*(DELTA - 1) - dp^2*exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logtilqp)*(DELTA - 1);
compressed_deriv(41)=-exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(42)=-exp(logmnomp - logmden - dp*exp(logthetap))*exp(logthetap)*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(43)=-dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logthetap)*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(44)=-exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(45)=exp(logmnomp - logmden - dp*exp(logthetap))*exp(logthetap)*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1)) - dp*exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(46)=dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logthetap)*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1)) - dp^2*exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(47)=-exp(logtilq);
compressed_deriv(48)=-exp(3*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(49)=2*exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1)) - dp*exp(3*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(50)=3*dp*exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1)) - exp(logmnomp - logmden - dp*exp(logthetap))*exp(logthetap)*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1)) - dp^2*exp(3*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
compressed_deriv(51)=3*dp^2*exp(2*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1)) - dp*exp(logmnomp - logmden - dp*exp(logthetap))*exp(logthetap)*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1)) - dp^3*exp(3*logthetap)*exp(logmnomp - logmden - dp*exp(logthetap))*(exp(logtilrp) - exp(logtilqp)*(DELTA - 1));
uncompressed_deriv=compressed_deriv(index.nnz{10,3});
full_vals(76:262)=uncompressed_deriv;
full_rows(76:262)=index.loc{10,3};
compressed_deriv=zeros(1,1);
compressed_deriv(1)=exp(logtilq);
uncompressed_deriv=compressed_deriv(index.nnz{11,3});
full_vals(263:263)=uncompressed_deriv;
full_rows(263:263)=index.loc{11,3};
compressed_deriv=zeros(1,1);
compressed_deriv(1)=(3*exp(2*nl))/(exp(nl) + 1)^2 - (2*exp(3*nl))/(exp(nl) + 1)^3 - exp(nl)/(exp(nl) + 1) + (ALPHA*exp(nl))/(exp(nl) + 1) - (3*ALPHA*exp(2*nl))/(exp(nl) + 1)^2 + (2*ALPHA*exp(3*nl))/(exp(nl) + 1)^3;
uncompressed_deriv=compressed_deriv(index.nnz{12,3});
full_vals(264:264)=uncompressed_deriv;
full_rows(264:264)=index.loc{12,3};
compressed_deriv=zeros(3,1);
compressed_deriv(1)=ALPHA*((2*exp(3*nl))/(exp(nl) + 1)^3 - (3*exp(2*nl))/(exp(nl) + 1)^2 + exp(nl)/(exp(nl) + 1));
compressed_deriv(2)=exp(logtheta) - ALPHA*exp(logtheta) + exp(logtheta)*(ALPHA - 1);
compressed_deriv(3)=d*exp(logtheta) + d*exp(logtheta)*(ALPHA - 1) - ALPHA*d*exp(logtheta);
uncompressed_deriv=compressed_deriv(index.nnz{13,3});
full_vals(265:269)=uncompressed_deriv;
full_rows(265:269)=index.loc{13,3};
compressed_deriv=zeros(4,1);
compressed_deriv(1)=(ALPHA - 1)*((2*exp(3*nl))/(exp(nl) + 1)^3 - (3*exp(2*nl))/(exp(nl) + 1)^2 + exp(nl)/(exp(nl) + 1));
compressed_deriv(2)=(3*exp(2*logtily))/(PHI + exp(logtily))^2 - exp(logtily)/(PHI + exp(logtily)) - (2*exp(3*logtily))/(PHI + exp(logtily))^3;
compressed_deriv(3)=exp(logtheta) - ALPHA*exp(logtheta) + exp(logtheta)*(ALPHA - 1);
compressed_deriv(4)=d*exp(logtheta) + d*exp(logtheta)*(ALPHA - 1) - ALPHA*d*exp(logtheta);
uncompressed_deriv=compressed_deriv(index.nnz{14,3});
full_vals(270:275)=uncompressed_deriv;
full_rows(270:275)=index.loc{14,3};
compressed_deriv=zeros(3,1);
compressed_deriv(1)=exp(logtilc);
compressed_deriv(2)=exp(logtilx);
compressed_deriv(3)=-exp(logtily);
uncompressed_deriv=compressed_deriv(index.nnz{15,3});
full_vals(276:278)=uncompressed_deriv;
full_rows(276:278)=index.loc{15,3};
compressed_deriv=zeros(3,1);
compressed_deriv(1)=-exp(logtilx);
compressed_deriv(2)=exp(logtilk)*(DELTA - 1);
compressed_deriv(3)=exp(logtilkstarbackp);
uncompressed_deriv=compressed_deriv(index.nnz{16,3});
full_vals(279:281)=uncompressed_deriv;
full_rows(279:281)=index.loc{16,3};
compressed_deriv=zeros(72,1);
compressed_deriv(1)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep));
compressed_deriv(2)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logtilqep);
compressed_deriv(3)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1));
compressed_deriv(4)=-exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep));
compressed_deriv(5)=-exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep));
compressed_deriv(6)=-dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep));
compressed_deriv(7)=-(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)))/(ALPHA - 1);
compressed_deriv(8)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logtilqep);
compressed_deriv(9)=-exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logtilqep);
compressed_deriv(10)=-exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*exp(logtilqep);
compressed_deriv(11)=-dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*exp(logtilqep);
compressed_deriv(12)=-(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logtilqep))/(ALPHA - 1);
compressed_deriv(13)=-exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1));
compressed_deriv(14)=-exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap);
compressed_deriv(15)=-dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap);
compressed_deriv(16)=-exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))/(ALPHA - 1);
compressed_deriv(17)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep));
compressed_deriv(18)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep));
compressed_deriv(19)=dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep));
compressed_deriv(20)=(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)))/(ALPHA - 1);
compressed_deriv(21)=exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep));
compressed_deriv(22)=dp*exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)) - exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep));
compressed_deriv(23)=(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep)))/(ALPHA - 1);
compressed_deriv(24)=dp^2*exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)) - dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep));
compressed_deriv(25)=(dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep)))/(ALPHA - 1);
compressed_deriv(26)=(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)))/(ALPHA - 1)^2;
compressed_deriv(27)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logtilqep);
compressed_deriv(28)=-exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logtilqep);
compressed_deriv(29)=-exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*exp(logtilqep);
compressed_deriv(30)=-dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*exp(logtilqep);
compressed_deriv(31)=-(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logtilqep))/(ALPHA - 1);
compressed_deriv(32)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logtilqep);
compressed_deriv(33)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*exp(logtilqep);
compressed_deriv(34)=dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*exp(logtilqep);
compressed_deriv(35)=(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logtilqep))/(ALPHA - 1);
compressed_deriv(36)=exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logtilqep);
compressed_deriv(37)=dp*exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logtilqep) - exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*exp(logtilqep);
compressed_deriv(38)=(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*exp(logtilqep))/(ALPHA - 1);
compressed_deriv(39)=dp^2*exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logtilqep) - dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*exp(logtilqep);
compressed_deriv(40)=(dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*exp(logtilqep))/(ALPHA - 1);
compressed_deriv(41)=(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logtilqep))/(ALPHA - 1)^2;
compressed_deriv(42)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1));
compressed_deriv(43)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap);
compressed_deriv(44)=dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap);
compressed_deriv(45)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))/(ALPHA - 1);
compressed_deriv(46)=exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1));
compressed_deriv(47)=dp*exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1)) - exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap);
compressed_deriv(48)=(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap))/(ALPHA - 1);
compressed_deriv(49)=dp^2*exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1)) - dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap);
compressed_deriv(50)=(dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap))/(ALPHA - 1);
compressed_deriv(51)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))/(ALPHA - 1)^2;
compressed_deriv(52)=-exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep));
compressed_deriv(53)=-exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep));
compressed_deriv(54)=-dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep));
compressed_deriv(55)=-(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)))/(ALPHA - 1);
compressed_deriv(56)=-exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep));
compressed_deriv(57)=exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep)) - dp*exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep));
compressed_deriv(58)=-(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep)))/(ALPHA - 1);
compressed_deriv(59)=dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep)) - dp^2*exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep));
compressed_deriv(60)=-(dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep)))/(ALPHA - 1);
compressed_deriv(61)=-(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)))/(ALPHA - 1)^2;
compressed_deriv(62)=-exp(logtilqe);
compressed_deriv(63)=-exp(3*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep));
compressed_deriv(64)=2*exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)) - dp*exp(3*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep));
compressed_deriv(65)=-(exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)))/(ALPHA - 1);
compressed_deriv(66)=3*dp*exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)) - exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep)) - dp^2*exp(3*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep));
compressed_deriv(67)=(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep)))/(ALPHA - 1) - (dp*exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)))/(ALPHA - 1);
compressed_deriv(68)=-(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep)))/(ALPHA - 1)^2;
compressed_deriv(69)=3*dp^2*exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)) - dp^3*exp(3*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)) - dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep));
compressed_deriv(70)=(dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep)))/(ALPHA - 1) - (dp^2*exp(2*logthetap)*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)))/(ALPHA - 1);
compressed_deriv(71)=-(dp*exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*exp(logthetap)*(tildivp + exp(logtilqep)))/(ALPHA - 1)^2;
compressed_deriv(72)=-(exp(logmnomp - logmden - (LAMBDA_A + zap + dp*exp(logthetap)*(ALPHA - 1))/(ALPHA - 1))*(tildivp + exp(logtilqep)))/(ALPHA - 1)^3;
uncompressed_deriv=compressed_deriv(index.nnz{18,3});
full_vals(282:573)=uncompressed_deriv;
full_rows(282:573)=index.loc{18,3};
compressed_deriv=zeros(6,1);
compressed_deriv(1)=(7*exp(logtilw + nl)*exp(nl))/(exp(nl) + 1)^2 - exp(logtilw + nl)/(exp(nl) + 1) - (12*exp(2*nl)*exp(logtilw + nl))/(exp(nl) + 1)^3 + (6*exp(3*nl)*exp(logtilw + nl))/(exp(nl) + 1)^4;
compressed_deriv(2)=(3*exp(logtilw + nl)*exp(nl))/(exp(nl) + 1)^2 - exp(logtilw + nl)/(exp(nl) + 1) - (2*exp(2*nl)*exp(logtilw + nl))/(exp(nl) + 1)^3;
compressed_deriv(3)=(exp(logtilw + nl)*exp(nl))/(exp(nl) + 1)^2 - exp(logtilw + nl)/(exp(nl) + 1);
compressed_deriv(4)=-exp(logtilw + nl)/(exp(nl) + 1);
compressed_deriv(5)=-exp(logtilx);
compressed_deriv(6)=exp(logtily);
uncompressed_deriv=compressed_deriv(index.nnz{19,3});
full_vals(574:583)=uncompressed_deriv;
full_rows(574:583)=index.loc{19,3};
compressed_deriv=zeros(5,1);
compressed_deriv(1)=exp(logmnomp - logmden);
compressed_deriv(2)=-exp(logmnomp - logmden);
compressed_deriv(3)=exp(logmnomp - logmden);
compressed_deriv(4)=-exp(logmnomp - logmden);
compressed_deriv(5)=-exp(logqf);
uncompressed_deriv=compressed_deriv(index.nnz{20,3});
full_vals(584:592)=uncompressed_deriv;
full_rows(584:592)=index.loc{20,3};
derivs=sparse(full_rows,ones(length(full_vals),1),full_vals,2211840,1);
