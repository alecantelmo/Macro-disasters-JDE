function derivs=stochtilf_tilf_d4(vars,params,index)
n_s=size(vars,1);
logcp=vars(:,1);
logc=vars(:,2);
logkp=vars(:,3);
logap=vars(:,4);
mpkp=vars(:,5);
logmpkp=vars(:,6);
mp=vars(:,7);
logmp=vars(:,8);
BETA=params(1);
GAMMA=params(2);
ALPHA=params(3);
RHO=params(4);
DELTA=params(5);
SIGMA=params(6);
full_rows=zeros(0,1);
full_cols=zeros(0,4);
full_vals=zeros(n_s,0);
derivs=sptensor(full_rows,full_cols,full_vals,1,repmat(8,1,4));
