function derivs=pretilf_tilf_d1(vars,params,index)
n_s=size(vars,1);
logc=vars(:,1);
logkp=vars(:,2);
logk=vars(:,3);
loga=vars(:,4);
logoutput=vars(:,5);
output=vars(:,6);
k=vars(:,7);
c=vars(:,8);
kp=vars(:,9);
invk=vars(:,10);
BETA=params(1);
GAMMA=params(2);
ALPHA=params(3);
RHO=params(4);
DELTA=params(5);
SIGMA=params(6);
full_rows=zeros(5,1);
full_cols=zeros(5,1);
full_vals=zeros(n_s,5);
compressed_deriv=zeros(n_s,5);
compressed_deriv(:,1)=invk;
compressed_deriv(:,2)=-invk.*(DELTA - 1);
compressed_deriv(:,3)=-invk;
compressed_deriv(:,4)=-invk;
compressed_deriv(:,5)=output - kp - c - k.*(DELTA - 1);
uncompressed_deriv=compressed_deriv(:,index.nnz{1,1});
full_vals(:,1:5)=uncompressed_deriv;
full_cols(1:5,:)=index.loc{1,1};
full_rows(1:5)=1;
derivs=sptensor(full_rows,full_cols,full_vals,1,repmat(10,1,1));
